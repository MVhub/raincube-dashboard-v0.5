{"version":3,"sources":["app.min.js"],"names":["config","$routeProvider","$locationProvider","when","templateUrl","controller","controllerAs","redirectTo","otherwise","html5Mode","run","$rootScope","$location","authentication","$on","event","nextRoute","currentRoute","path","isLoggedIn","angular","module","dashboardCtrl","weather","dayAsString","dayIndex","weekdays","Array","setForecastData","forecastData","forEach","current","index","forecast","iconName","getWeatherIcon","icon","name","day","Date","time","getDay","rainProbability","Math","floor","precipProbability","rainIntensity","precipIntensityMax","toFixed","rainIntensityHeight","getRainIntensityStyle","height","rainIntensityWidth","width","vm","forecasts","push","weatherIcons","rain","overcast","sunny","windy","lightning","this","timeInterval","heavyRain","getForecast","success","data","daily","error","err","console","log","setTime","timeLength","$inject","homeCtrl","profileCtrl","meanData","user","getProfile","e","facebookLoginCtrl","$routeParams","saveToken","token","loginCtrl","credentials","email","password","onSubmit","login","alert","then","registerCtrl","firstName","lastName","register","$http","$window","localStorage","getToken","payload","split","atob","JSON","parse","exp","now","currentUser","post","logout","removeItem","service","get","headers","Authorization","zipCode","navigationCtrl","fullname","navigation","restrict","directive"],"mappings":"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","file":"app.min.js","sourcesContent":["(function () {\n\n  angular.module('raincubeApp', ['ngRoute']);\n\n  function config ($routeProvider, $locationProvider) {\n    $routeProvider\n      .when('/', {\n        templateUrl: 'home/home.view.html',\n        controller: 'homeCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/register', {\n        templateUrl: '/auth/register/register.view.html',\n        controller: 'registerCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/login', {\n        templateUrl: '/auth/login/login.view.html',\n        controller: 'loginCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/profile', {\n        templateUrl: '/profile/profile.view.html',\n        controller: 'profileCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/auth/facebook', {\n        redirectTo: function () {\n          return \"/auth/facebook\";\n        }\n      })\n      .when('/fb/:token', {\n        templateUrl: '/dashboard/dashboard.view.html',\n        controller: 'facebookLoginCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/dashboard', {\n        templateUrl: '/dashboard/dashboard.view.html',\n        controller: 'dashboardCtrl',\n        controllerAs: 'vm'\n      })\n      .otherwise({redirectTo: '/'});\n\n    // use the HTML5 History API\n    $locationProvider.html5Mode(true);\n  }\n\n  function run($rootScope, $location, authentication) {\n    $rootScope.$on('$routeChangeStart', function(event, nextRoute, currentRoute) {\n      if ($location.path() === '/profile' && !authentication.isLoggedIn()) {\n        $location.path('/');\n      }\n\n      if ($location.path() === '/dashboard' && !authentication.isLoggedIn()) {\n        $location.path('/');\n      }\n    });\n  }\n  \n  angular\n    .module('raincubeApp')\n    .config(['$routeProvider', '$locationProvider', config])\n    .run(['$rootScope', '$location', 'authentication', run]);\n\n})();\n(function() {\n  \n  angular\n    .module('raincubeApp')\n    .controller('dashboardCtrl', dashboardCtrl);\n\n  dashboardCtrl.$inject = ['$location', 'weather'];\n  function dashboardCtrl($location, weather) {\n    var vm = this;\n\n    vm.forecasts = [];\n    vm.timeInterval = [10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60];\n\n    var weatherIcons = {\n        \"rain\": \"./images/rc_raining.svg\",\n        \"heavyRain\": \"./images/rc_heavy_rain.svg\",\n        \"lightning\": \"./images/rc_lightning.svg\",\n        \"overcast\": \"./images/rc_overcast.svg\",\n        \"sunny\": \"./images/rc_sunny.svg\",\n        \"windy\": \"./images/rc_windy.svg\"\n    }\n\n    weather\n        .getForecast('33569')\n        .success(function(data) {\n            setForecastData(data.daily.data);\n        })\n        .error(function (err) {\n            console.log(err);\n        });\n\n    function dayAsString(dayIndex) {\n        var weekdays = new Array(7);\n        weekdays[0] = \"SUN\";\n        weekdays[1] = \"MON\";\n        weekdays[2] = \"TUE\";\n        weekdays[3] = \"WED\";\n        weekdays[4] = \"THU\";\n        weekdays[5] = \"FRI\";\n        weekdays[6] = \"SAT\";\n\n        return weekdays[dayIndex];\n    }\n\n    function setForecastData(forecastData) {\n        forecastData.forEach(function (current, index) {\n            var forecast = {\n                iconName: getWeatherIcon(current.icon).name,\n                icon: getWeatherIcon(current.icon).icon,\n                day: dayAsString(new Date(current.time * 1000).getDay()),\n                rainProbability: Math.floor(current.precipProbability * 100),\n                rainIntensity: (current.precipIntensityMax * 24).toFixed(2),\n                rainIntensityHeight: getRainIntensityStyle((current.precipIntensityMax * 24).toFixed(2)).height,\n                rainIntensityWidth: getRainIntensityStyle((current.precipIntensityMax * 24).toFixed(2)).width\n            };\n\n            vm.forecasts.push(forecast);\n        });\n    }\n\n    function getWeatherIcon(iconName) {\n        switch (iconName) {\n            case 'rain':\n            case \"snow\":\n            case \"sleet\":\n                return { icon: weatherIcons.rain, name: 'RAINY' };\n            case \"cloudy\":\n            case \"fog\":\n            case \"partly-cloudy-day\":\n            case \"partly-cloudy-night\":\n                return { icon: weatherIcons.overcast, name: 'CLOUDY' };\n            case \"clear-day\":\n            case \"clear-night\":\n                return { icon: weatherIcons.sunny, name: 'SUNNY' };\n            case \"wind\":\n                return { icon: weatherIcons.windy, name: 'WINDY' };\n            case \"thunderstorm\":\n                return { icon: weatherIcons.lightning, name: 'STORMY' };\n            default:\n                return { icon: weatherIcons.sunny, name: 'SUNNY' };\n        }\n    }\n\n    function getRainIntensityStyle(rainIntensity) {\n        switch (true) {\n            case (rainIntensity == 0):\n                return {height: \"1px\", width: \"1px\"};\n            case (rainIntensity < 0.25):\n                return {height: \"5px\", width: \"5px\"};\n            case (rainIntensity < 0.5):\n                return {height: \"10px\", width: \"10px\"};\n            case (rainIntensity < 1):\n                return {height: \"15px\", width: \"15px\"};\n            case (rainIntensity >= 1):\n                return {height: \"20px\", width: \"20px\"};\n            default:\n                return {height: \"5px\", width: \"5px\"};\n        }\n    }\n\n    vm.setTime = function (time) {\n        vm.timeLength = time;\n    }\n  }\n\n})();\n(function() {\n  \n  angular\n    .module('raincubeApp')\n    .controller('homeCtrl', homeCtrl);\n\n    function homeCtrl () {\n      console.log('Home controller is running');\n    }\n\n})();\n(function() {\n  \n  angular\n    .module('raincubeApp')\n    .controller('profileCtrl', profileCtrl);\n\n  profileCtrl.$inject = ['$location', 'meanData'];\n  function profileCtrl($location, meanData) {\n    var vm = this;\n\n    vm.user = {};\n\n    meanData.getProfile()\n      .success(function(data) {\n        vm.user = data;\n      })\n      .error(function (e) {\n        console.log(e);\n      });\n  }\n\n})();\n(function () {\n\n  angular\n  .module('raincubeApp')\n  .controller('facebookLoginCtrl', facebookLoginCtrl);\n\n  facebookLoginCtrl.$inject = ['$location', '$routeParams', 'authentication'];\n  function facebookLoginCtrl($location, $routeParams, authentication) {\n    var vm = this;\n\n    authentication.saveToken($routeParams.token);\n\n    $location.path('dashboard');\n  }\n\n})();\n(function () {\n\n  angular\n  .module('raincubeApp')\n  .controller('loginCtrl', loginCtrl);\n\n  loginCtrl.$inject = ['$location', 'authentication'];\n  function loginCtrl($location, authentication) {\n    var vm = this;\n\n    vm.credentials = {\n      email : \"\",\n      password : \"\"\n    };\n\n    vm.onSubmit = function () {\n      authentication\n        .login(vm.credentials)\n        .error(function(err){\n          alert(err);\n        })\n        .then(function(){\n          $location.path('dashboard');\n        });\n    };\n\n  }\n\n})();\n(function () {\n\n  angular\n    .module('raincubeApp')\n    .controller('registerCtrl', registerCtrl);\n\n  registerCtrl.$inject = ['$location', 'authentication'];\n  function registerCtrl($location, authentication) {\n    var vm = this;\n\n    vm.credentials = {\n      firstName : \"\",\n      lastName: \"\",\n      email : \"\",\n      password : \"\"\n    };\n\n    vm.onSubmit = function () {\n      authentication\n        .register(vm.credentials)\n        .error(function(err){\n          alert(err);\n        })\n        .then(function(){\n          $location.path('profile');\n        });\n    };\n\n  }\n\n})();\n(function () {\n\n  angular\n    .module('raincubeApp')\n    .service('authentication', authentication);\n\n  authentication.$inject = ['$http', '$window', '$location'];\n  function authentication ($http, $window, $location) {\n\n    var saveToken = function (token) {\n      $window.localStorage['mean-token'] = token;\n    };\n\n    var getToken = function () {\n      return $window.localStorage['mean-token'];\n    };\n\n    var isLoggedIn = function() {\n      var token = getToken();\n      var payload;\n\n      if(token){\n        payload = token.split('.')[1];\n        payload = $window.atob(payload);\n        payload = JSON.parse(payload);\n\n        return payload.exp > Date.now() / 1000;\n      } else {\n        return false;\n      }\n    };\n\n    var currentUser = function() {\n      if(isLoggedIn()){\n        var token = getToken();\n        var payload = token.split('.')[1];\n        payload = $window.atob(payload);\n        payload = JSON.parse(payload);\n        return {\n          email : payload.email,\n          firstName : payload.firstName,\n          lastName: payload.lastName\n        };\n      }\n    };\n\n    register = function(user) {\n      return $http.post('/register', user).success(function(data){\n        saveToken(data.token);\n      });\n    };\n\n    login = function(user) {\n      return $http.post('/login', user).success(function(data) {\n        saveToken(data.token);\n      });\n    };\n\n    logout = function() {\n      $window.localStorage.removeItem('mean-token');\n      $location.path('/');\n    };\n\n    return {\n      currentUser : currentUser,\n      saveToken : saveToken,\n      getToken : getToken,\n      isLoggedIn : isLoggedIn,\n      register : register,\n      login : login,\n      logout : logout\n    };\n  }\n\n\n})();\n(function() {\n\n  angular\n    .module('raincubeApp')\n    .service('meanData', meanData);\n\n  meanData.$inject = ['$http', 'authentication'];\n  function meanData ($http, authentication) {\n\n    var getProfile = function () {\n      return $http.get('/api/profile', {\n        headers: {\n          Authorization: 'Bearer '+ authentication.getToken()\n        }\n      });\n    };\n\n    return {\n      getProfile : getProfile\n    };\n  }\n\n})();\n(function () {\n\n  angular\n    .module('raincubeApp')\n    .service('weather', weather);\n\n  weather.$inject = ['$http', '$window', '$location'];\n  function weather ($http, $window, $location) {\n\n    getForecast = function(zipCode) {\n      return $http.get('/forecast/' + zipCode);\n    };\n\n    return {\n      getForecast: getForecast\n    };\n  }\n\n\n})();\n(function () {\n\n  angular\n    .module('raincubeApp')\n    .controller('navigationCtrl', navigationCtrl);\n\n  navigationCtrl.$inject = ['$location','authentication'];\n  function navigationCtrl($location, authentication) {\n    var vm = this;\n\n    vm.isLoggedIn = authentication.isLoggedIn();\n  \n    vm.currentUser = authentication.currentUser();\n    \n    if (vm.currentUser) {\n      vm.currentUser.fullname = vm.currentUser.firstName + ' ' + vm.currentUser.lastName;\n    }\n \n    vm.logout = function () {\n      authentication.logout();\n    };\n  }\n\n})();\n(function () {\n\n  angular\n    .module('raincubeApp')\n    .directive('navigation', navigation);\n\n  function navigation () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/common/directives/navigation/navigation.template.html',\n      controller: 'navigationCtrl as navvm'\n    };\n  }\n\n})();"]}